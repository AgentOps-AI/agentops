---
title: "REST API"
description: "Direct integration with AgentOps API"
---

The AgentOps REST API allows you to integrate agent monitoring directly into your application without using our Python SDK. This is useful for:
- Non-Python applications
- Custom integrations
- Direct API access

For a complete API reference, you can view our [OpenAPI specification](https://api.agentops.ai/v2/openapi.yaml).

## Authentication

The AgentOps API uses a two-step authentication process:
1. API Key: Used to create sessions and get JWT tokens
2. JWT: Used for all operations within a session

### Initial Authentication

When you create a session, you'll use your API key and receive a JWT token in response:

<CodeGroup>
```bash curl
curl -X POST https://api.agentops.ai/v2/create_session \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -H "X-Agentops-Api-Key: your_api_key" \
  -d '{
    "session": {
      "session_id": "550e8400-e29b-41d4-a716-446655440000",
      "init_timestamp": "2024-03-14T12:00:00Z",
      "tags": ["production"],
      "host_env": {
        "OS": {
          "OS": "Windows",
          "OS Release": "11"
        }
      }
    }
  }'
```

```json Success Response (200 OK)
{
  "status": "success",
  "jwt": "eyJhbGciOiJIUzI1NiIs...",
  "session_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

```json Error Response (401 Unauthorized)
{
  "error": "Invalid API key",
  "message": "Please check your API key and try again"
}
```

```json Error Response (400 Bad Request)
{
  "error": "Invalid request",
  "message": "Missing required fields or invalid format"
}
```
</CodeGroup>

### Using JWT Tokens

Use the JWT token in the Authorization header for all subsequent requests:

<CodeGroup>
```bash Example Request
curl -X POST https://api.agentops.ai/v2/create_events \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIs..." \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -d '{
    "events": [{
      "event_type": "llm",
      "init_timestamp": "2024-03-14T12:01:00Z",
      "end_timestamp": "2024-03-14T12:01:02Z",
      "session_id": "550e8400-e29b-41d4-a716-446655440000",
      "model": "gpt-4",
      "prompt": [
        {"role": "system", "content": "You are a helpful assistant"},
        {"role": "user", "content": "Analyze this data..."}
      ],
      "completion": {
        "role": "assistant",
        "content": "Based on the data..."
      },
      "prompt_tokens": 150,
      "completion_tokens": 80
    }]
  }'
```

```json Error Response (401 Unauthorized)
{
  "error": "Invalid or expired JWT",
  "message": "Please reauthorize using /v2/reauthorize_jwt"
}
```

```json Error Response (429 Too Many Requests)
{
  "error": "Rate limit exceeded",
  "message": "Please try again later"
}
```
</CodeGroup>

### Refreshing Tokens

JWTs expire after 24 hours. When a token expires, use your API key to get a new one:

<CodeGroup>
```bash curl
curl -X POST https://api.agentops.ai/v2/reauthorize_jwt \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -H "X-Agentops-Api-Key: your_api_key" \
  -d '{
    "session_id": "550e8400-e29b-41d4-a716-446655440000"
  }'
```

```json Success Response (200 OK)
{
  "status": "success",
  "jwt": "eyJhbGciOiJIUzI1NiIs..."
}
```

```json Error Response (401 Unauthorized)
{
  "error": "Invalid API key",
  "message": "Please check your API key and try again"
}
```
</CodeGroup>

## Error Handling

The API uses standard HTTP status codes:

| Status Code | Description |
|------------|-------------|
| 200 | Success |
| 400 | Invalid Request - Check request format and required fields |
| 401 | Unauthorized - Invalid or missing API key/JWT |
| 408 | Request Timeout |
| 413 | Payload Too Large |
| 429 | Too Many Requests - Rate limit exceeded |
| 500 | Internal Server Error |

## Session Management

Sessions require a unique identifier that you generate client-side. While any unique string will work, we recommend using UUIDs for consistency. Here's how to generate one in Python:

<CodeGroup>
```python Python
import uuid
session_id = str(uuid.uuid4())
# "550e8400-e29b-41d4-a716-446655440000"
```
</CodeGroup>

### Create Session

Start a new monitoring session using your generated session ID:

<CodeGroup>
```bash curl
curl -X POST https://api.agentops.ai/v2/create_session \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -H "X-Agentops-Api-Key: your_api_key" \
  -d '{
    "session": {
      "session_id": "550e8400-e29b-41d4-a716-446655440000",
      "init_timestamp": "2024-03-14T12:00:00Z",
      "tags": ["production", "customer-service"],
      "host_env": {
        "OS": {
          "OS": "Windows",
          "OS Release": "11",
          "OS Version": "10.0.22631"
        },
        "CPU": {
          "CPU Usage": "5.9%",
          "Total cores": 12
        },
        "RAM": {
          "Used": "14.49 GB",
          "Total": "31.75 GB"
        },
        "SDK": {
          "Python Version": "3.12.0",
          "System Packages": {
            "agentops": "0.3.17",
            "openai": "1.2.3"
          }
        }
      }
    }
  }'
```

```bash Request
POST https://api.agentops.ai/v2/create_session
Content-Type: application/json
X-Agentops-Api-Key: your_api_key

{
  "session": {
    "session_id": "550e8400-e29b-41d4-a716-446655440000",
    "init_timestamp": "2024-03-14T12:00:00Z",
    "tags": ["production", "customer-service"],
    "host_env": {
      "OS": {
        "OS": "Windows",
        "OS Release": "11",
        "OS Version": "10.0.22631"
      },
      "CPU": {
        "CPU Usage": "5.9%",
        "Total cores": 12
      },
      "RAM": {
        "Used": "14.49 GB",
        "Total": "31.75 GB"
      },
      "SDK": {
        "Python Version": "3.12.0",
        "System Packages": {
          "agentops": "0.3.17",
          "openai": "1.2.3"
        }
      }
    }
  }
}
```
</CodeGroup>

### Update Session

Update an existing session (e.g., when it ends):

<CodeGroup>
```bash curl
curl -X POST https://api.agentops.ai/v2/update_session \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -H "Authorization: Bearer your_jwt_token" \
  -d '{
    "session": {
      "session_id": "550e8400-e29b-41d4-a716-446655440000",
      "end_timestamp": "2024-03-14T12:05:00Z",
      "end_state": "Success",
      "end_state_reason": "Task successfully completed",
      "tags": ["production", "updated-tag"]
    }
  }'
```

```bash Request
POST https://api.agentops.ai/v2/update_session
Content-Type: application/json
Authorization: Bearer your_jwt_token

{
  "session": {
    "session_id": "550e8400-e29b-41d4-a716-446655440000",
    "end_timestamp": "2024-03-14T12:05:00Z",
    "end_state": "Success",
    "end_state_reason": "Task successfully completed",
    "tags": ["production", "updated-tag"]
  }
}
```
</CodeGroup>

## Event Tracking

### Create Events

Track LLM calls, tool usage, or other events:

<CodeGroup>
```bash curl
curl -X POST https://api.agentops.ai/v2/create_events \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -H "Authorization: Bearer your_jwt_token" \
  -d '{
    "events": [
      {
        "event_type": "llm",
        "init_timestamp": "2024-03-14T12:01:00Z",
        "end_timestamp": "2024-03-14T12:01:02Z",
        "session_id": "550e8400-e29b-41d4-a716-446655440000",
        "model": "gpt-4",
        "prompt": [
          {"role": "system", "content": "You are a helpful assistant"},
          {"role": "user", "content": "Analyze this data..."}
        ],
        "completion": {
          "role": "assistant",
          "content": "Based on the data..."
        },
        "prompt_tokens": 150,
        "completion_tokens": 80
      },
      {
        "event_type": "tool",
        "name": "database_query",
        "init_timestamp": "2024-03-14T12:01:03Z",
        "end_timestamp": "2024-03-14T12:01:04Z",
        "input": "SELECT * FROM users",
        "output": "Retrieved 5 users"
      }
    ]
  }'
```

```bash Request
POST https://api.agentops.ai/v2/create_events
Content-Type: application/json
Authorization: Bearer your_jwt_token

{
  "events": [
    {
      "event_type": "llm",
      "init_timestamp": "2024-03-14T12:01:00Z",
      "end_timestamp": "2024-03-14T12:01:02Z",
      "session_id": "550e8400-e29b-41d4-a716-446655440000",
      "model": "gpt-4",
      "prompt": [
        {"role": "system", "content": "You are a helpful assistant"},
        {"role": "user", "content": "Analyze this data..."}
      ],
      "completion": {
        "role": "assistant",
        "content": "Based on the data..."
      },
      "prompt_tokens": 150,
      "completion_tokens": 80
    },
    {
      "event_type": "tool",
      "name": "database_query",
      "init_timestamp": "2024-03-14T12:01:03Z",
      "end_timestamp": "2024-03-14T12:01:04Z",
      "input": "SELECT * FROM users",
      "output": "Retrieved 5 users"
    }
  ]
}
```
</CodeGroup>

### Update Events

Update existing events (e.g., adding completion information):

<CodeGroup>
```bash curl
curl -X POST https://api.agentops.ai/v2/update_events \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -H "Authorization: Bearer your_jwt_token" \
  -d '{
    "events": [
      {
        "event_id": "event-id-123",
        "end_timestamp": "2024-03-14T12:01:02Z",
        "completion": "Updated completion text",
        "completion_tokens": 100
      }
    ]
  }'
```

```bash Request
POST https://api.agentops.ai/v2/update_events
Content-Type: application/json
Authorization: Bearer your_jwt_token

{
  "events": [
    {
      "event_id": "event-id-123",
      "end_timestamp": "2024-03-14T12:01:02Z",
      "completion": "Updated completion text",
      "completion_tokens": 100
    }
  ]
}
```
</CodeGroup>

## Agent Management

### Create Agent

Register a new agent in a session:

<CodeGroup>
```bash curl
curl -X POST https://api.agentops.ai/v2/create_agent \
  -H "Content-Type: application/json; charset=UTF-8" \
  -H "Accept: */*" \
  -H "Authorization: Bearer your_jwt_token" \
  -d '{
    "id": "agent-123",
    "name": "Research Assistant"
  }'
```

```bash Request
POST https://api.agentops.ai/v2/create_agent
Content-Type: application/json
Authorization: Bearer your_jwt_token

{
  "id": "agent-123",
  "name": "Research Assistant"
}
```
</CodeGroup>

## Example Integration

Here's a complete example using Python's requests library:

<CodeGroup>
```python Complete Example
import requests
import uuid
from datetime import datetime, timezone
import json

# Configuration
API_KEY = "your_api_key"
BASE_URL = "https://api.agentops.ai"
HEADERS = {
    "Content-Type": "application/json; charset=UTF-8",
    "Accept": "*/*"
}

def handle_response(response):
    """Handle API response and common errors"""
    try:
        response.raise_for_status()
        return response.json()
    except requests.exceptions.HTTPError as e:
        if response.status_code == 401:
            print("Authentication error. Check your API key or JWT token.")
        elif response.status_code == 429:
            print("Rate limit exceeded. Please try again later.")
        elif response.status_code == 400:
            print("Invalid request format:", response.json().get("message"))
        else:
            print(f"HTTP error occurred: {e}")
        return None
    except Exception as e:
        print(f"An error occurred: {e}")
        return None

# Create session
session_id = str(uuid.uuid4())
create_session_headers = {**HEADERS, "X-Agentops-Api-Key": API_KEY}
session_response = requests.post(
    f"{BASE_URL}/v2/create_session",
    headers=create_session_headers,
    json={
        "session": {
            "session_id": session_id,
            "init_timestamp": datetime.now(timezone.utc).isoformat(),
            "tags": ["example"]
        }
    }
)

session_data = handle_response(session_response)
if not session_data:
    print("Failed to create session")
    exit(1)

jwt_token = session_data["jwt"]

# Track LLM call
event_headers = {**HEADERS, "Authorization": f"Bearer {jwt_token}"}
event_response = requests.post(
    f"{BASE_URL}/v2/create_events",
    headers=event_headers,
    json={
        "events": [{
            "event_type": "llm",
            "init_timestamp": datetime.now(timezone.utc).isoformat(),
            "end_timestamp": datetime.now(timezone.utc).isoformat(),
            "session_id": session_id,
            "model": "gpt-4",
            "prompt": "Hello, world!",
            "completion": "Hi there!",
            "prompt_tokens": 3,
            "completion_tokens": 2
        }]
    }
)

if not handle_response(event_response):
    print("Failed to create event")
    exit(1)

# End session
end_response = requests.post(
    f"{BASE_URL}/v2/update_session",
    headers=event_headers,
    json={
        "session": {
            "session_id": session_id,
            "end_timestamp": datetime.now(timezone.utc).isoformat(),
            "end_state": "Success"
        }
    }
)

if not handle_response(end_response):
    print("Failed to end session")
```
</CodeGroup>
